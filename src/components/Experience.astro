---
import { experience } from '../data/portfolio';
---

<section id="experience" class="max-w-7xl mx-auto px-6 mb-32">
  <h2 class="text-4xl md:text-5xl font-display font-bold mb-16 text-center">
    Professional <span class="text-brand-500">Journey</span>
  </h2>
  
  <div class="relative">
    <!-- Enhanced Timeline Line with Gradient -->
    <div class="hidden md:block absolute left-1/2 transform -translate-x-1/2 w-1 h-full bg-gradient-to-b from-brand-500 via-cyan-500 to-purple-500 opacity-30 rounded-full"></div>
    
    <!-- Animated dots along timeline -->
    <div class="hidden md:block absolute left-1/2 transform -translate-x-1/2 w-2 h-full">
      {experience.map((_, index) => (
        <div 
          class="absolute w-3 h-3 bg-brand-500 rounded-full animate-pulse left-1/2 transform -translate-x-1/2"
          style={`top: ${(index * 100) / experience.length}%; animation-delay: ${index * 0.5}s`}
        ></div>
      ))}
    </div>
    
    <div class="space-y-12">
      {experience.map((job, index) => (
        <div class={`experience-item relative md:grid md:grid-cols-2 md:gap-12 ${index % 2 === 1 ? 'md:flex-row-reverse' : ''}`}
             style={`animation-delay: ${index * 0.2}s`}>
          <!-- Left/Right Content -->
          <div class={`flex flex-col ${index % 2 === 1 ? 'md:text-right md:order-2 items-start' : 'items-end'}`}>
            {job.current && (
              <div class="inline-flex items-center gap-2 px-4 py-1 rounded-full bg-green-100 dark:bg-green-500/10 border border-green-600 dark:border-green-700 text-green-800 dark:text-green-500 text-xs font-bold uppercase tracking-widest mb-3 animate-bounce-subtle">
                  <span class="relative flex h-2 w-2">
                      <span class="animate-ping absolute inline-flex h-full w-full rounded-full bg-green-400 opacity-75"></span>
                      <span class="relative inline-flex rounded-full h-2 w-2 bg-green-500"></span>
                  </span>
                  CURRENT ROLE
              </div>
            )}
            <h3 class="text-2xl font-bold mb-2 hover:text-brand-500 transition-colors">{job.position}</h3>
            <p class="text-brand-500 font-bold mb-2 flex items-center gap-2">
              <i class={`${job.icon} ${job.iconColor}`}></i>
              {job.company}
            </p>
            <p class="text-slate-500 dark:text-slate-400 text-sm mb-4">
              <i class="fas fa-calendar mr-2"></i>{job.period} â€¢ <i class="fas fa-map-marker-alt ml-2 mr-2"></i>{job.location}
            </p>
          </div>
          
          <!-- Card Content -->
          <div class={`relative mt-4 md:mt-0 ${index % 2 === 1 ? 'md:order-1' : ''}`}>
            <!-- Enhanced Timeline Node -->
            <div class={`absolute ${index % 2 === 1 ? 'md:left-auto md:right-0 md:translate-x-1/2' : 'left-1/2 md:left-0 md:-translate-x-1/2'} transform -translate-x-1/2 w-6 h-6 bg-gradient-to-br from-brand-500 to-cyan-500 rounded-full border-4 border-white dark:border-brand-950 z-10 hidden md:flex items-center justify-center shadow-lg`}>
              <div class="w-2 h-2 bg-white rounded-full animate-pulse"></div>
            </div>
            
            <!-- Enhanced Card with 3D Effect -->
            <div class="job-card group p-6 bg-gradient-to-br from-brand-500/10 to-cyan-500/10 rounded-2xl border border-slate-200 dark:border-slate-800 hover:border-brand-500 hover:shadow-2xl hover:shadow-brand-500/20 transition-all duration-300 cursor-pointer">
              <!-- Card Header with Icon -->
              <div class="flex items-center gap-3 mb-4">
                <div class={`w-10 h-10 ${job.iconColor.replace('text-', 'bg-').replace('-500', '-500/20')} rounded-lg flex items-center justify-center`}>
                  <i class={`${job.icon} ${job.iconColor} text-lg`}></i>
                </div>
                <div class="flex-1">
                  <div class="text-xs text-slate-500 dark:text-slate-400 uppercase tracking-wide">Achievement Highlights</div>
                </div>
              </div>

              <!-- Achievements List -->
              <ul class="space-y-3 text-slate-600 dark:text-slate-400 mb-4">
                {job.achievements.map((achievement, achIndex) => (
                  <li class="flex items-start gap-3 achievement-item" style={`animation-delay: ${(index * 0.2) + (achIndex * 0.1)}s`}>
                    <i class={`${job.icon} ${job.iconColor} mt-1 text-sm`}></i>
                    <span set:html={achievement.replace(/\*\*(.*?)\*\*/g, '<strong class="text-slate-900 dark:text-white">$1</strong>')} />
                  </li>
                ))}
              </ul>

              <!-- Technologies with Enhanced Styling -->
              <div class="flex flex-wrap gap-2 pt-4 border-t border-slate-200 dark:border-slate-800">
                {job.technologies.map((tech, techIndex) => (
                  <span 
                    class="tech-badge px-3 py-1 bg-gradient-to-br from-brand-500/20 to-cyan-500/20 dark:bg-slate-800 dark:border-slate-700 rounded-full text-xs font-bold border border-brand-500/30 hover:scale-110 hover:shadow-md transition-all cursor-pointer"
                    style={`animation-delay: ${(index * 0.2) + (techIndex * 0.05)}s`}
                  >
                    {tech}
                  </span>
                ))}
              </div>

              <!-- Hover Indicator -->
              <div class="absolute top-4 right-4 opacity-0 group-hover:opacity-100 transition-opacity">
                <i class="fas fa-arrow-right text-brand-500 animate-bounce-horizontal"></i>
              </div>
            </div>
          </div>
        </div>
      ))}
    </div>
  </div>

<style>
  .experience-item {
    opacity: 0;
    animation: slideIn 0.8s ease-out forwards;
  }

  @keyframes slideIn {
    from {
      opacity: 0;
      transform: translateY(30px);
    }
    to {
      opacity: 1;
      transform: translateY(0);
    }
  }

  .job-card {
    position: relative;
    transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
  }

  .job-card::before {
    content: '';
    position: absolute;
    inset: 0;
    border-radius: 1rem;
    padding: 2px;
    background: linear-gradient(135deg, transparent, rgba(76, 151, 155, 0.3), transparent);
    -webkit-mask: linear-gradient(#fff 0 0) content-box, linear-gradient(#fff 0 0);
    mask: linear-gradient(#fff 0 0) content-box, linear-gradient(#fff 0 0);
    -webkit-mask-composite: xor;
    mask-composite: exclude;
    opacity: 0;
    transition: opacity 0.3s;
  }

  .job-card:hover::before {
    opacity: 1;
  }

  .achievement-item {
    opacity: 0;
    animation: fadeInLeft 0.6s ease-out forwards;
  }

  @keyframes fadeInLeft {
    from {
      opacity: 0;
      transform: translateX(-20px);
    }
    to {
      opacity: 1;
      transform: translateX(0);
    }
  }

  .tech-badge {
    opacity: 0;
    animation: popIn 0.4s ease-out forwards;
  }

  @keyframes popIn {
    0% {
      opacity: 0;
      transform: scale(0.5);
    }
    50% {
      transform: scale(1.1);
    }
    100% {
      opacity: 1;
      transform: scale(1);
    }
  }

  @keyframes bounce-subtle {
    0%, 100% {
      transform: translateY(0);
    }
    50% {
      transform: translateY(-5px);
    }
  }

  .animate-bounce-subtle {
    animation: bounce-subtle 2s ease-in-out infinite;
  }

  @keyframes bounce-horizontal {
    0%, 100% {
      transform: translateX(0);
    }
    50% {
      transform: translateX(5px);
    }
  }

  .animate-bounce-horizontal {
    animation: bounce-horizontal 1s ease-in-out infinite;
  }
</style>
